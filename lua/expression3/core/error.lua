local tokens = EXPR_TOKENS;

--[[
*****************************************************************************************************************************************************
	create a new extention
*****************************************************************************************************************************************************
]]--

local extension = EXPR_LIB.RegisterExtension("error");

--[[
*****************************************************************************************************************************************************
	register error class
*****************************************************************************************************************************************************
]]--

local class_error = extension:RegisterClass({
	id = "er",
	name = "error",
	isType = istable,
	isValid = EXPR_LIB.NOTNIL
})

--[[
*****************************************************************************************************************************************************
	error constructor
*****************************************************************************************************************************************************
]]--

extension:RegisterConstructor("er", "s", function(ctx, msg)
	local err = {};
	err.state = "runtime";
	err.char = 0;
	err.line = 0;
	err.msg = msg;
	err.ctx = tokens[ctx];
	return err;
end);


--[[
*****************************************************************************************************************************************************
	Error methods
*****************************************************************************************************************************************************
]]--

extension:RegisterMethod("er", "message", "", "s", 1, function(err)
	return err and err.msg or "n/a";
end, true);

extension:RegisterMethod("er", "char", "", "n", 1, function(err)
	return err and err.char or 0;
end, true);

extension:RegisterMethod("er", "line", "", "n", 1, function(err)
	return err and err.line or 0;
end, true);

--[[
*****************************************************************************************************************************************************
	
*****************************************************************************************************************************************************
]]--

extension:EnableExtension();











